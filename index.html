<script>
    // 标准格式映射表保持不变...

    // 修改后的数据源配置
    const sources = {
        v2fly: {
            // 保持原有v2fly配置不变...
        },
        clash: {
            name: "Clash",
            baseUrl: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/",
            info: "blackmatrix7/ios_rule_script (Clash)",
            check: async function(name) {
                const lowerName = name.toLowerCase();
                const originalName = name;
                
                const generateFormats = (name) => {
                    const camelCase = name.split(/[-_]/)
                        .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                        .join('');
                    
                    return [
                        camelCase,
                        camelCase.charAt(0).toUpperCase() + camelCase.slice(1).toLowerCase(),
                        originalName,
                        originalName.toUpperCase()
                    ];
                };

                const formatsToTry = [...new Set(generateFormats(lowerName))];

                let matchedFormat = '';
                for (const format of formatsToTry) {
                    try {
                        const response = await fetch(`${this.baseUrl}${format}/${format}.list`, { method: 'HEAD' });
                        if (response.ok) {
                            matchedFormat = format;
                            return { exists: true, format: matchedFormat };
                        }
                    } catch {
                        continue;
                    }
                }
                return { exists: false, format: formatsToTry[0] };
            }
        }
    };

    // 修改后的查询功能
    document.getElementById('checkBtn').addEventListener('click', async function() {
        // ...前面代码保持不变
        
        try {
            const results = await Promise.all(
                names.map(name => {
                    if (currentSource === sources.v2fly) {
                        return sources.v2fly.check(name)
                            .then(exists => ({ exists, format: name.toLowerCase() }));
                    } else {
                        return sources.clash.check(name);
                    }
                })
            );

            const maxLen = Math.max(...names.map(name => name.length));
            results.forEach((result, index) => {
                const div = document.createElement('div');
                div.className = 'result-item';
                
                const displayName = names[index].padEnd(maxLen);
                const exists = result.exists;
                const formatInfo = result.exists 
                    ? `匹配格式: ${result.format}/${result.format}.list`
                    : `建议尝试: ${result.format}`;

                div.innerHTML = `
                    ${displayName} : 
                    <span class="${exists ? 'exists' : 'not-exists'}">
                        ${exists ? '✓ 存在' : '✗ 不存在'}
                    </span>
                    <small class="text-muted">(${currentSource.name})</small>
                    <div class="${exists ? 'query-info' : 'format-suggestion'}">${formatInfo}</div>
                `;
                resultsDiv.appendChild(div);
            });
        } catch (error) {
            // ...错误处理保持不变
        }
        // ...后面代码保持不变
    });
</script>
