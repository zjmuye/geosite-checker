<script>
    // Clash 查询逻辑修改：尝试不同格式
    const sources = {
        v2fly: {
            name: "v2fly",
            baseUrl: "https://raw.githubusercontent.com/v2fly/domain-list-community/master/data/",
            info: "v2fly/domain-list-community",
            check: async function(name) {
                try {
                    const response = await fetch(`${this.baseUrl}${name.toLowerCase()}`, { method: 'HEAD' });
                    return response.ok;
                } catch {
                    return false;
                }
            }
        },
        clash: {
            name: "Clash",
            baseUrl: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/",
            info: "blackmatrix7/ios_rule_script (Clash)",
            check: async function(name) {
                const lowerName = name.toLowerCase();
                const capitalizedName = lowerName.replace(/\b\w/g, c => c.toUpperCase()); // GoogleVoice
                const firstUpperCase = lowerName.charAt(0).toUpperCase() + lowerName.slice(1); // Googlevoice
                const upperName = name.toUpperCase(); // GOOGLEVOICE

                // 按顺序尝试不同格式
                const formatsToTry = [capitalizedName, firstUpperCase, name, upperName];

                for (const format of formatsToTry) {
                    try {
                        const response = await fetch(`${this.baseUrl}${format}/${format}.list`, { method: 'HEAD' });
                        if (response.ok) return true;
                    } catch {
                        continue;
                    }
                }
                return false;
            }
        }
    };
</script>
